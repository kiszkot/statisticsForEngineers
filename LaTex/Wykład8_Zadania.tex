\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{polski}
\usepackage{amsmath,amssymb,graphicx,subfig,pdfpages,enumitem,empheq,verbatim,csvsimple}

\author{Krystian Baran 145000}
\title{WykÅ‚ad 8 - Zadania 2 i 5}

\begin{document}

\maketitle
\newpage

\tableofcontents
\newpage

\section{Zadanie 2 - Funkcje testÃ³w w R}

W jÄ™zyku programowania R istniejÄ… rÃ³Å¼ne funkcji do wykonywania testÃ³w, natomiast zatrzymamy siÄ™ na najwaÅ¼niejszych.

\subsection{t.test()}
Funkcja do wykonania testu t-Studenta dla ktÃ³rego zakÅ‚ada siÄ™ Å¼e dane pochodzÄ… z rozkÅ‚adu normalnego z parametrami nieznanymi. Parametry tej funkcj sÄ… nastÄ™pujÄ…ce:
\begin{itemize}
\item \textbf{x} - wektor wartoÅ›ci prÃ³by
\item \textbf{y} - wektor wartoÅ›ci prÃ³by do porÃ³wnania z prÃ³bÄ… $x$. Opcjonalny
\item \textbf{alternative} - specyfikacja hipotezy alternatywnej przyjmujÄ…ce wartoÅ›ci: "two.sided", "greater", "less"
\item \textbf{mu} - wartoÅ›Ä‡ prawdziwej wartoÅ›ci oczekiwanej lub rÃ³Å¼nica miÄ™dzy wartoÅ›ciami oczekiwanymi dla dwÃ³ch prÃ³b
\item \textbf{paired} - logiczna wartoÅ›Ä‡ dla "paired" testu
\item \textbf{var.equal} - logiczna mÃ³wiÄ…ca czy traktowaÄ‡ wariancje jako takie same lub nie. Gdy FALSE korzysta siÄ™ z aproksymacja Welcha.
\item \textbf{conf.equal} - confidence level
\item \textbf{formula} - "lhs" dla numerycznej zmiennej oddajÄ…cej wartoÅ›ci, "rhs" dla two pionowÄ… korespondencji grup.
\item \textbf{data} - Opcjonalna macierz z wartoÅ›ciami uÅ¼ytych do polu \textit{formula}
\item \textbf{subset}  - Opcjonalny wektor z podzbiorem obserwacji do wykorzystania w teÅ›cie
\item \textbf{na.action} - funkcja definiujÄ…ca co siÄ™ dzieje gdy napotkane zostajÄ… wartoÅ›ci \textit{NA}
\end{itemize}

Oddawane przez tÄ… funkcje wartoÅ›ci sÄ… nastÄ™pujÄ…ce:
\begin{itemize}
\item \textbf{statistic} - wartoÅ›Ä‡ statystyki t
\item \textbf{parameter} - stopnie swobody statystyki t
\item \textbf{p.value} - \textit{p value} wykonanego testu
\item \textbf{conf.int} - przedziaÅ‚ ufnoÅ›ci dla wartoÅ›ci oczekiwanej
\item \textbf{estimate} - estymowana wartoÅ›Ä‡ oczekiwana lub rÃ³Å¼nica wartoÅ›ci oczekiwanych dla testu dwÃ³ch prÃ³b
\item \textbf{null.value} - podana wartoÅ›Ä‡ \textit{mu}
\item \textbf{stderr} - standardowy bÅ‚Ä…d wartoÅ›ci oczekiwanej, uÅ¼ywany jako mianownik statystyki t
\item \textbf{alternative} - opis hipotezy alternatywnej
\item \textbf{method} - typ wykonanego testu t
\item \textbf{data.name} - imiÄ™ podanej macierz pod \textit{data}
\end{itemize}

\subsection{wilcox.test()}
Test Wilcoxona wykorzystany jest do badania wartoÅ›ci oczekiwanej jak w teÅ›cie t-Studenta ale nie zakÅ‚ada siÄ™ Å¼e prÃ³ba ma rozkÅ‚ad normalny. Funkcja ta przyjmuje nastÄ™pujÄ…ce parametry:
\begin{itemize}
\item \textbf{x} - wektor liczb na podstawie ktÃ³rej bÄ™dzie test prowadzony
\item \textbf{y} - wektor liczb w przypadku testu dwÃ³ch prÃ³b
\item \textbf{mu} - wartoÅ›Ä‡ oczekiwana hipotezy zerowej
\item \textbf{paired} - logiczna dla testu "paired"
\item \textbf{exact} - logiczna mÃ³wiÄ…ca czy dokÅ‚adna wartoÅ›Ä‡ \textit{p value} powinna byÄ‡ liczona
\item \textbf{correct} - logiczna mÃ³wiÄ…ca czy \textit{p value} powinna byÄ‡ poprawiona ze wzglÄ™du na ciÄ…gÅ‚osÄ‡
\item \textbf{conf.int} - logiczna mÃ³wiÄ…ca czy powinien zostaÄ‡ liczony przedziaÅ‚ ufnoÅ›ci
\item \textbf{conf.level} - poziom ufnoÅ›ci testu
\item \textbf{formula} - "lhs" dla numerycznej zmiennej oddajÄ…cej wartoÅ›ci, "rhs" dla two pionowÄ… korespondencji grup.
\item \textbf{data} - Opcjonalna macierz z wartoÅ›ciami uÅ¼ytych do polu \textit{formula}
\item \textbf{subset}  - Opcjonalny wektor z podzbiorem obserwacji do wykorzystania w teÅ›cie
\item \textbf{na.action} - funkcja definiujÄ…ca co siÄ™ dzieje gdy napotkane zostajÄ… wartoÅ›ci \textit{NA}
\end{itemize}

Funkcja ta oddaje podobne wartoÅ›ci jak test t-Studenta:
\begin{itemize}
\item \textbf{statistic} - wartoÅ›Ä‡ statystyki z imieniem opisujÄ…cym
\item \textbf{parameter} - parametry dokÅ‚adnego rozkÅ‚adu statystyki testowej
\item \textbf{p.value} - \textit{p value} wykonanego testu
\item \textbf{null.value} - podana wartoÅ›Ä‡ \textit{mu}
\item \textbf{alternative} - opis hipotezy alternatywnej
\item \textbf{method} - typ wykonanego testu
\item \textbf{data.name} - imiÄ™ podanej macierz pod \textit{data}
\item \textbf{conf.int} - przedziaÅ‚ ufnoÅ›ci dla wartoÅ›ci oczekiwanej
\item \textbf{estimate} - estymowana wartoÅ›Ä‡ oczekiwana lub rÃ³Å¼nica wartoÅ›ci oczekiwanych dla testu dwÃ³ch prÃ³b
\end{itemize}

\subsection{var.test()}
Test ten jest testem F Snedecora dla porÃ³wnania wariancji pomiÄ™dzy dwoma populacjami. Funkcja ta przyjmuje nastÄ™pujÄ…ce wartoÅ›ci:
\begin{itemize}
\item \textbf{x, y} - wektory liczb dla ktÃ³rych przeprowadzony jest test
\item \textbf{ratio} - hipotetyczny "ratio" pomiÄ™dzy badanymi wariancjami
\item \textbf{alternative} - hipoteza alternatywna, przyjmuje wartoÅ›ci: "two.sided", "greater", "less"
\item \textbf{conf.level} - poziom ufnoÅ›ci testu
\item \textbf{formula} - "lhs" dla numerycznej zmiennej oddajÄ…cej wartoÅ›ci, "rhs" dla two pionowÄ… korespondencji grup.
\item \textbf{data} - Opcjonalna macierz z wartoÅ›ciami uÅ¼ytych do polu \textit{formula}
\item \textbf{subset}  - Opcjonalny wektor z podzbiorem obserwacji do wykorzystania w teÅ›cie
\item \textbf{na.action} - funkcja definiujÄ…ca co siÄ™ dzieje gdy napotkane zostajÄ… wartoÅ›ci \textit{NA}
\end{itemize}

Funkcja ta zwraca listÄ™ typu "htest" zawierajÄ…ca nastÄ™pujÄ…ce komponenty:
\begin{itemize}
\item \textbf{statistic} - wartoÅ›Ä‡ statystyki F-test
\item \textbf{parameter} - stopnie swobody rozkÅ‚adu F dla testu
\item \textbf{p.value} - \textit{p value} wykonanego testu
\item \textbf{conf.int} - przedziaÅ‚ ufnoÅ›ci dla wartoÅ›ci oczekiwanej
\item \textbf{estimate} - estymowana wartoÅ›Ä‡ oczekiwana lub rÃ³Å¼nica wartoÅ›ci oczekiwanych dla testu dwÃ³ch prÃ³b
\item \textbf{null.value} - "ratio" wariancji populacji podane
\item \textbf{alternative} - opis hipotezy alternatywnej
\item \textbf{method} - typ wykonanego testu
\item \textbf{data.name} - imiÄ™ podanej macierz pod \textit{data}
\end{itemize}

\subsection{ks.test()}
Funckja do wykonania testu na dwÃ³ch prÃ³bach w celu sprawdzenia czy majÄ… ten sam rozkÅ‚ad. Funkcja ta przyjmuje nastÄ™pujÄ…ce wartosci:
\begin{itemize}
\item \textbf{x} - wektor wartoÅ›ci
\item \textbf{y} - wektor wartoÅ›ci lub Å‚aÅ„cuch opisujÄ…cy dystrybuantÄ™ rozkÅ‚adu
\item \textbf{alternative} - hipoteza alternatywna, przyjmuje wartoÅ›ci: "two.sided", "greater", "less"
\item \textbf{exact} - logiczna mÃ³wiÄ…ca czy dokÅ‚adna wartoÅ›Ä‡ \textit{p value} powinna byÄ‡ liczona
\item \textbf{tol} - gÃ³rny koniec przedziaÅ‚u dla bÅ‚Ä™du zaokrÄ…glania
\item \textbf{simulate.p.value} - logiczna mÃ³wiÄ…ca czy symulowaÄ‡ \textit{p value} wedÅ‚ug Monte Carlo
\item \textbf{B} - liczba replikatÃ³w dla testu Monte Carlo
\end{itemize}

Funkcja ta zwraca listÄ™ typu "htest" zawierajÄ…ca nastÄ™pujÄ…ce komponenty:
\begin{itemize}
\item \textbf{statistic} - wartoÅ›Ä‡ statystyki testowej
\item \textbf{p.value} - \textit{p value} wykonanego testu
\item \textbf{alternative} - opis hipotezy alternatywnej
\item \textbf{method} - typ wykonanego testu
\item \textbf{data.name} - imiÄ™ podanej macierz pod \textit{data}
\end{itemize}

\newpage
\section{Zadanie 4 - Studium przypadku}
Pascal jest jÄ™zykiem programowania wysokiego poziomu, stosowanym czÄ™sto do oprogramowywania mikrokomputerÃ³w. W celu zbadania wskaÅºnika p zmiennych pascalowych typu tablicowego zostaÅ‚ przeprowadzony eksperyment. DwadzieÅ›cia zmiennych zostaÅ‚o losowo wybranych ze zbioru programÃ³w pascalowych i liczba $X$ zmiennych typu tablicowego zostaÅ‚a odnotowana. Celem poznawczym jest zweryfikowanie hipotezy, Å¼e pascal jest jÄ™zykiem o wiÄ™kszej wydolnoÅ›ci (tj. ma wiÄ™kszy udziaÅ‚ zmiennych typu tablicowego) niÅ¼ algol, dla ktÃ³rego, jak pokazaÅ‚o doÅ›wiadczenie, jedynie 20\% zmiennych jest typu tablicowego.
\begin{enumerate}[label = \alph*)]
\item SkonstruowaÄ‡ test statystyczny do zweryfikowania postawionej hipotezy.
\item ZnaleÅºÄ‡ $\alpha$ dla zbioru odrzuceÅ„ $X\geq8$.
\item ZnaleÅºÄ‡ $\alpha$ dla zbioru odrzuceÅ„ $X\geq5$.
\item ZnaleÅºÄ‡ $\beta$ dla zbioru odrzuceÅ„ $X\geq8$, jeÅ¼eli $p=0,5$ (doÅ›wiadczenie pokazuje, Å¼e okoÅ‚o poÅ‚owa zmiennych w programach pascalowskich jest typu tablicowego).
\item ZnaleÅºÄ‡ $\beta$ dla zbioru odrzuceÅ„ $X\geq5$, jeÅ¼eli $p=0,5$.
\item KtÃ³ry ze zbiorÃ³w odrzuceÅ„ $X\geq8$ czy $X\geq5$ jest bardziej poÅ¼Ä…dany, jeÅ¼eli minimalizowany jest:
	\begin{enumerate}[label = \Alph*)]
	\item bÅ‚Ä…d I rodzaju?
	\item bÅ‚Ä…d II rodzaju?
	\end{enumerate}
\item ZnaleÅºÄ‡ jednostronny zbiÃ³r odrzuceÅ„ postaci $X\geq a$, tak aby poziom ufnoÅ›ci byÅ‚ w przybliÅ¼eniu rÃ³wny $\alpha=0,01$.
\item Dla zbioru odrzuceÅ„ wyznaczonego w poprzednim punkcie znaleÅºÄ‡ moc testu, jeÅ¼eli $p=0,4$.
\item Dla zbioru odrzuceÅ„ wyznaczonego w punkcie g) znaleÅºÄ‡ moc testu, jeÅ¼eli $p=0,7$.
\end{enumerate}

\subsection{a)}
Oznaczmy jako $X$ liczbÄ™ zmiennych typu tablicowego w Pascal z losowo wybranych, wtedy $X$ ma rozkÅ‚ad dwumianowy z nieznanym parametrem $p$. ZaÅ‚Ã³Å¼my Å¼e liczby typu tablicowego wylosowane z programu Algog ma takÅ¼e rozkÅ‚ad dwumianowy gdzie natomiast jest znany parametr $p = 0.2$. Wtedy hipoteza Å¼e Pascal jest jÄ™zykiem programowania o wiÄ™kszej zdolnoÅ›ci niÅ¼ Algol, czyli Å¼e $p$ liczb typu tablicowego w Pascal jest wiÄ™ksza niÅ¼ $p$ dla liczb tablicowych w Algol. Jest to hipoteza alternatywa poniewaÅ¼ wstÄ™puje ostra nierÃ³wnoÅ›Ä‡, zatem stosujÄ…c normy statystyki moÅ¼na wyznaczyÄ‡ hipotezÄ™ zerowa.
\begin{center} \begin{tabular}{|c|c|} \hline
$H_0$ & $p \leq p_0 = 0.2$ \\ \hline
$H_1$ & $p > p_0 = 0.2$ \\ \hline
\end{tabular} \end{center}

Znany jest rozkÅ‚ad ale nie znany jest parametr $p$, musimy sprawdziÄ‡ poniÅ¼szy warunek aby mÃ³c zastosowaÄ‡ statystykÄ™.
\[ 0 < p_0 \mp \sqrt{\frac{p_0(1-p_0)}{n}} = 0.2 \mp \sqrt{\frac{0.16}{20}} < 1 \]
SpeÅ‚niony jest warunek zatem moÅ¼emy zastosowaÄ‡ statystykÄ™ ktÃ³ra jest zbliÅ¼ona do rozkÅ‚adu $N(0,1)$:
\[ Z = \frac{\overline{P}_n - p_0}{\sqrt{\frac{p_0(1-p_0)}{n}}} \]

\subsection{b)}
ZbiÃ³r odrzuceÅ„ jest zbiorem dla ktÃ³rego, jeÅ¼eli liczba liczb tablicowych siÄ™ znajdzie odrzucamy hipotezÄ™ zerowÄ… tj Å¼e Pascal jest mniej wydajny. Zatem dla $X\geq 8$ zbiÃ³r krytyczny jest nastÄ™pujÄ…cy:
\[ R = \{ 8,9,\dots,20 \} \]

Wtedy bÅ‚Ä…d pierwszego rodzaju, zakÅ‚adajÄ…c Å¼e dla $H_0$ $p=0.2$ jest nastÄ™pujÄ…cy:
\begin{align*} \alpha & = P(U_n \in R|H_0) = P(X \geq 8) = 1 - P(X \leq 7) \\
& \overset{R}{=} 1 - pbinom(7, 20, 0.2) \approx 0.03214266 \end{align*}

\subsection{c)}
Podobnie jak w poprzednim podpunkcie wyznaczymy zbiÃ³r krytyczny:
\[ R = \{ 5, 6, \dots, 20 \} \]

Wtedy, zakÅ‚adajÄ…c jak poprzednio, bÅ‚Ä…d pierwszego rodzaju wynosi:
\begin{align*} \alpha & = P(U_n \in R|H_0) = P(X \geq 5) = 1 - P(X \leq 4) \\
& \overset{R}{=} 1 - pbinom(4, 20, 0.2) \approx 0.3703517 \end{align*}

\subsection{d)}
Jak dla podpunktu b, zbiÃ³r wartoÅ›ci krytycznych jest nastÄ™pujÄ…cy:
\[ R = \{ 8,9,\dots,20 \} \]

Natomiast potrzebujemy obliczyÄ‡ bÅ‚Ä…d drugiego rodzaju, to znaczy Å¼e zakÅ‚adamy Å¼e hipoteza alternatywna jest prawdziwa, czyli Å¼e Pascal jest bardziej wydajnym programem, i zakÅ‚adamy Å¼e $p = 0.5$. Wtedy szykane $\beta$ wyraÅ¼a siÄ™ nastÄ™pujÄ…cym wzorem:
\begin{align*}
\beta & = 1 - P(U_n \in R |H_1) = 1 - P(X \geq 8) = P(X \leq 7) \\
& \overset{R}{=} pbinom(7, 20, 0.5) \approx 0.131588
\end{align*}
Zatem $\beta$ wynosi okoÅ‚o 0.1326.

\subsection{e)}
ZbiÃ³r wartoÅ›ci krytycznych jest jak w podpunkcie c:
\[ R = \{ 5, 6, \dots, 20 \} \]

Natomiast obliczamy bÅ‚Ä…d  drugiego rodzaju jak dla poprzedniego podpunktu, czyli:
\begin{align*}
\beta & = 1 - P(U_n \in R |H_1) = 1 - P(X \geq 5) = P(X \leq 4) \\
& \overset{R}{=} pbinom(4, 20, 0.5) \approx 0.005908966
\end{align*}
Zatem $\beta$ wynosi okoÅ‚o 0.0059.

\subsection{f)}
Nie rozwiÄ…zane.

\subsection{g)}
Szukamy wartoÅ›Ä‡ $a$ taka aby bÅ‚Ä…d pierwszego rodzaju byÅ‚ rÃ³wny 0.01. Zatem, korzystajÄ…c z poprzednich podpunktÃ³w moÅ¼na tÄ™ wartoÅ›Ä‡ wyznaczyÄ‡:
\begin{align*}
\alpha = 0.01 &= 1 - P(X \leq a-1) \\
P(X \leq a-1) & = 0.99 \\
a-1 & = F^{-1}(0.99) \overset{R}{=} qbinom(0.99, 20, 0.2) = 8 \\
a & = 9
\end{align*}

Zatem dla $X \geq 9$ bÅ‚Ä…d pierwszego rodzaju wynosi 0.01.

\subsection{h)}
Jak w poprzednich podpunktach obliczymy bÅ‚Ä…d drugiego rodzaju i na jego podstawie moc testu. Przyjmujemy wartoÅ›Ä‡ $p = 0.4$.
\[ \beta = 1 - P(X \leq 8) \overset{R}{=} 1 - pbinom(8, 20, 0.4) \approx 0.4044013 \]
Wtedy moc testu wynosi $1 - \beta = 0.5955987$.

\subsection{i)}
Nie rozwiÄ…zane.
Jak w poprzednim podpunkcie obliczymy moc testu na podstawie bÅ‚Ä™du drugiego rodzaju przyjmujÄ…c $p = 0.7$.
\[ \beta = 1 - P(X \leq 8) \overset{R}{=} 1 - pbinom(8, 20, 0.7) \approx 0.9948618 \]
Wtedy moc testu wynosi $1 - \beta = 0.005138162$.


% Odp. b) 0.032, c) 0.370, d) 0.132, e) 0.006, f) A) ğ‘‹â‰¥8; B) ğ‘‹â‰¥5, g) ğ‘‹â‰¥9, h) 0,596, i) 0,005.

\section{Bibliografia}
\begin{itemize}
\item https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test
\item https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/wilcox.test
\item https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/var.test
\item https://www.rdocumentation.org/packages/dgof/versions/1.2/topics/ks.test
\end{itemize}

\end{document}